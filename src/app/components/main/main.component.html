<div class="main-container">

    <div class="options-container">
        <div class="indicators-container">
            <button (click)="clearIndicators()" class="clear-button">Clear</button>
            <div>
                <div *ngFor="let indicatorGroup of this.indicatorService.availableIndicators; let indicatorSectionIndex = index">
                    <strong>{{ indicatorGroup.title }}</strong>
                    <div [class]="'indicator-group-list indicator-group-list-' + indicatorGroup.title.toLocaleLowerCase()">
                        <div *ngFor="let indicator of indicatorGroup.indicators; let indicatorIndex = index"
                             class="checkbox-with-label indicator-toggle"
                        >
                            <input type="checkbox"
                                   [id]="'indicator-checkbox-' + indicatorSectionIndex + '-' + indicatorIndex"
                                   [checked]="indicatorService.isActive(indicator)"
                                   (click)="indicatorService.toggleActive(indicator)"
                            >
                            <label [for]="'indicator-checkbox-' + indicatorSectionIndex + '-' + indicatorIndex">{{ indicator.longDescription }}</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="chart-settings">
            <div class="checkbox-with-label">
                <input type="checkbox" [(ngModel)]="settingsService.showCharts" id="show-charts-toggle">
                <label for="show-charts-toggle">Show Charts</label>
            </div>
            <div>
                <input type="number" [(ngModel)]="settingsService.chartDays" id="chart-days-input">
                <label for="chart-days-input">Chart Days</label>
            </div>
        </div>
        <div>
            <div class="checkbox-with-label">
                <input type="checkbox" [(ngModel)]="settingsService.showDates" id="show-dates-toggle">
                <label for="show-dates-toggle">Show Dates</label>
            </div>
            <div class="checkbox-with-label">
                <input type="checkbox" [(ngModel)]="settingsService.showTimespans" id="show-timespans-toggle">
                <label for="show-timespans-toggle">Show Timespans</label>
            </div>
            <div class="checkbox-with-label">
                <input type="checkbox" [(ngModel)]="settingsService.showTags" id="show-tags-toggle">
                <label for="show-tags-toggle">Show Tags</label>
            </div>
            <div class="checkbox-with-label">
                <input type="checkbox" [(ngModel)]="settingsService.showDescriptions" id="show-descriptions-toggle">
                <label for="show-descriptions-toggle">Show Descriptions</label>
            </div>
        </div>
    </div>

    <div class="actions-container">
        <div>
            <button (click)="fetch()">fetch</button>
            older than
            <input type="number" [(ngModel)]="fetchDays">
            days
        </div>
        <div>
            <button (click)="editAssets()">edit</button>
            /
            <button (click)="refreshAssets()">refresh</button>
            assets
        </div>
    </div>

    <div class="tags-container">
        <button (click)="filterService.enableAllTags()">All</button>
        <button (click)="filterService.disableAllTags()">None</button>
        <app-tag *ngFor="let tag of assetService.allUniqueTags" [tag]="tag"></app-tag>
    </div>

    <div class="search-box">
        <input [(ngModel)]="filterService.searchTerm"
               autocomplete="off"
               autocapitalize="off"
               spellcheck="false"
        >
        <span class="search-clear" (click)="clearSearchTerm()" >&#10005;</span>
    </div>

    <div class="header-container" [class.with-chart]="settingsService.showCharts">
        <div>
            <strong>Symbol</strong>
        </div>
        <div *ngIf="settingsService.showCharts">
            <strong>Chart</strong>
        </div>
        <div *ngFor="let indicator of indicatorService.activeIndicators"
             (click)="onIndicatorHeaderClick(indicator)"
             class="indicator-header"
        >
            <strong>{{ indicator.shortDescription }}</strong>
            <span *ngIf="sortService.sortIndicator === indicator" class="sort-symbol">
                <ng-container *ngIf="sortService.descending; else ascendingTriangle">
                    &#9660;
                </ng-container>
                <ng-template #ascendingTriangle>
                    &#9650;
                </ng-template>
            </span>
        </div>
    </div>

    <app-asset *ngFor="let asset of assets" [asset]="asset"></app-asset>

</div>